@echo off

:: Set the folder to save the downloaded wallpaper
set "imageUrl=https://i.redd.it/rzxjvaufvf9a1.jpg"
set "imageFolder=%USERPROFILE%\Pictures\Wallpapers"
set "imageFile=%imageFolder%\wallpaper.jpg"

:: Check if the folder exists, if not, create it
if not exist "%imageFolder%" (
    mkdir "%imageFolder%"
)

:: Download the wallpaper using PowerShell
powershell -Command "(New-Object System.Net.WebClient).DownloadFile('%imageUrl%', '%imageFile%')"

:: Disable Copilot button on taskbar
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowCopilotButton" /t REG_DWORD /d 0 /f

:: Hide Desktop Icons
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideIcons" /t REG_DWORD /d 1 /f

:: Hide Widgets Button
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "TaskbarDa" /t REG_DWORD /d 0 /f

:: Hide Task View Button
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowTaskViewButton" /t REG_DWORD /d 0 /f

:: Hide Search Box
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Search" /v "SearchboxTaskbarMode" /t REG_DWORD /d 0 /f

:: Change the theme to dark or light mode (0 for Light mode, 1 for Dark mode)
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "AppsUseLightTheme" /t REG_DWORD /d 0 /f
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "SystemUsesLightTheme" /t REG_DWORD /d 0 /f


::change the pin icons
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /v "Favorites" /t REG_BINARY /d 00A40100003A001F80C827341F105C1042AA032EE45287D668260001002600EFBE120000001A1197155F25DB01CD8C30265F25DB01D5C13C265F25DB011400560031000000000057599B7A11005461736B42617200400009000400EFBE57599B7A57599B7A2E000000BA5A18000000010000000000000000000000000000002B4D86005400610073006B00420061007200000016001201320097010000A754662A200046494C4545587E312E4C4E4B00007C0009000400EFBE57599B7A57599B7A2E000000BC5A1800000001000000000000000000520000000000A413A200460069006C00650020004500780070006C006F007200650072002E006C006E006B00000040007300680065006C006C00330032002E0064006C006C002C002D003200320030003600370000001C00120000002B00EFBEE7323F265F25DB011C00420000001D00EFBE02004D006900630072006F0073006F00660074002E00570069006E0064006F00770073002E004500780070006C006F0072006500720000001C00260000001E00EFBE0200530079007300740065006D00500069006E006E006500640000001C00000000500100003A001F80C827341F105C1042AA032EE45287D668260001002600EFBE120000001A1197155F25DB01CD8C30265F25DB0180AFED297C25DB01140056003100000000005759F59511005461736B42617200400009000400EFBE57599B7A5759F6952E000000BA5A18000000010000000000000000000000000000004B3498005400610073006B0042006100720000001600BE003200C508000057599D7A2000474F4F474C457E312E4C4E4B0000540009000400EFBE57591296575912962E000000B1AA10000000040000000000000000000000000000004AC2630047006F006F0067006C00650020004300680072006F006D0065002E006C006E006B0000001C00120000002B00EFBE80AFED297C25DB011C001A0000001D00EFBE02004300680072006F006D00650000001C00220000001E00EFBE02005500730065007200500069006E006E006500640000001C000000001206000014001F809BD434424502F34DB7803893943456E1FC050000FA0441505053E80408000300000000000000780200003153505355284C9F799F394BA8D0E1D42DE1D5F36100000011000000001F000000280000004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B0079006200330064003800620062007700650000001100000027000000000B000000FFFF0000110000000E00000000130000000200000011000000190000000013000000010000008500000015000000001F000000390000004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F0031002E00320031002E0032003900310031002E0030005F007800360034005F005F003800770065006B00790062003300640038006200620077006500000000006900000005000000001F0000002C0000004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B0079006200330064003800620062007700650021004100700070000000BD0000000F000000001F0000005600000043003A005C00500072006F006700720061006D002000460069006C00650073005C00570069006E0064006F007700730041007000700073005C004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F0031002E00320031002E0032003900310031002E0030005F007800360034005F005F003800770065006B0079006200330064003800620062007700650000001D000000200000000048000000961020451B12594FAA1FDE0AAAA6F82E00000000CD010000315350534D0BD48669903C44819A2A54090DCCEC4D0000000C000000001F0000001D00000049006D0061006700650073005C0053007100750061007200650031003500300078003100350030004C006F0067006F002E0070006E006700000000004900000002000000001F0000001B00000049006D0061006700650073005C00530071007500610072006500340034007800340034004C006F0067006F002E0070006E00670000000000490000000D000000001F0000001B00000049006D0061006700650073005C00570069006400650033003100300078003100350030004C006F0067006F002E0070006E00670000000000110000000400000000130000000078D4FF11000000050000000013000000FFFFFFFF3D00000013000000001F0000001500000049006D0061006700650073005C004C006100720067006500540069006C0065002E0070006E00670000000000110000000E0000000013000000A1040000250000000B000000001F000000090000005400650072006D0069006E0061006C00000000003D00000014000000001F0000001500000049006D0061006700650073005C0053006D0061006C006C00540069006C0065002E0070006E00670000000000000000003100000031535053B1166D44AD8D7048A748402EA43D788C15000000640000000015000000036E01000000000000000000410000003153505330F125B7EF471A10A5F102608C9EEBAC250000000A000000001F000000090000005400650072006D0069006E0061006C0000000000000000002D00000031535053B377ED0D14C66C45AE5B285B38D7B01B110000000700000000130000000000000000000000000000000000640000001D00EFBE02004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B00790062003300640038006200620077006500210041007000700000000005120000002B00EFBE0D30EA167C25DB010005640000001D00EFBE02004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B00790062003300640038006200620077006500210041007000700000000005220000001E00EFBE02005500730065007200500069006E006E0065006400000000050000FF /f

reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband" /v "FavoritesResolve" /t REG_BINARY /d 3B0300004C0000000114020000000000C0000000000000468300800020000000543634265F25DB0110E33F265F25DB015CF4E1FBD161D801970100000000000001000000000000000000000000000000A0013A001F80C827341F105C1042AA032EE45287D668260001002600EFBE120000001A1197155F25DB01CD8C30265F25DB01D5C13C265F25DB011400560031000000000057599B7A11005461736B42617200400009000400EFBE57599B7A57599B7A2E000000BA5A18000000010000000000000000000000000000002B4D86005400610073006B00420061007200000016000E01320097010000A754662A200046494C4545587E312E4C4E4B00007C0009000400EFBE57599B7A57599B7A2E000000BC5A1800000001000000000000000000520000000000A413A200460069006C00650020004500780070006C006F007200650072002E006C006E006B00000040007300680065006C006C00330032002E0064006C006C002C002D003200320030003600370000001C00220000001E00EFBE02005500730065007200500069006E006E006500640000001C00120000002B00EFBEE7323F265F25DB011C00420000001D00EFBE02004D006900630072006F0073006F00660074002E00570069006E0064006F00770073002E004500780070006C006F0072006500720000001C000000A40000001C000000010000001C0000002D00000000000000A300000011000000030000005CDBE3F41000000000433A5C55736572735C686572626572742E726F6368615C417070446174615C526F616D696E675C4D6963726F736F66745C496E7465726E6574204578706C6F7265725C517569636B204C61756E63685C557365722050696E6E65645C5461736B4261725C46696C65204578706C6F7265722E6C6E6B000060000000030000A058000000000000006C6162352D6463782D31370000000000A092522BA375E546942ECC3C757695C7E09E5E697390EF1184DD38FC9823D1C3A092522BA375E546942ECC3C757695C7E09E5E697390EF1184DD38FC9823D1C345000000090000A03900000031535053B1166D44AD8D7048A748402EA43D788C1D00000068000000004800000040E6AE068C8D1849B56AB7FACA8F623A000000000000000000000000EB0200004C0000000114020000000000C00000000000004683008000200000001C4DEB297C25DB0180AFED297C25DB01B6A6C1285F25DB01C5080000000000000100000000000000000000000000000050013A001F80C827341F105C1042AA032EE45287D668260001002600EFBE120000001A1197155F25DB01CD8C30265F25DB0180AFED297C25DB01140056003100000000005759F59511005461736B42617200400009000400EFBE57599B7A5759F6952E000000BA5A18000000010000000000000000000000000000004B3498005400610073006B0042006100720000001600BE003200C508000057599D7A2000474F4F474C457E312E4C4E4B0000540009000400EFBE57591296575912962E000000B1AA10000000040000000000000000000000000000004AC2630047006F006F0067006C00650020004300680072006F006D0065002E006C006E006B0000001C00220000001E00EFBE02005500730065007200500069006E006E006500640000001C00120000002B00EFBE80AFED297C25DB011C001A0000001D00EFBE02004300680072006F006D00650000001C000000A40000001C000000010000001C0000002D00000000000000A300000011000000030000005CDBE3F41000000000433A5C55736572735C686572626572742E726F6368615C417070446174615C526F616D696E675C4D6963726F736F66745C496E7465726E6574204578706C6F7265725C517569636B204C61756E63685C557365722050696E6E65645C5461736B4261725C476F6F676C65204368726F6D652E6C6E6B000060000000030000A058000000000000006C6162352D6463782D31370000000000A092522BA375E546942ECC3C757695C7C277DEB86291EF1184DD38FC9823D1C3A092522BA375E546942ECC3C757695C7C277DEB86291EF1184DD38FC9823D1C345000000090000A03900000031535053B1166D44AD8D7048A748402EA43D788C1D00000068000000004800000040E6AE068C8D1849B56AB7FACA8F623A000000000000000000000000640600004C0000000114020000000000C0000000000000468100800000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000120614001F809BD434424502F34DB7803893943456E1FC050000FA0441505053E80408000300000000000000780200003153505355284C9F799F394BA8D0E1D42DE1D5F36100000011000000001F000000280000004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B0079006200330064003800620062007700650000001100000027000000000B000000FFFF0000110000000E00000000130000000200000011000000190000000013000000010000008500000015000000001F000000390000004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F0031002E00320031002E0032003900310031002E0030005F007800360034005F005F003800770065006B00790062003300640038006200620077006500000000006900000005000000001F0000002C0000004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B0079006200330064003800620062007700650021004100700070000000BD0000000F000000001F0000005600000043003A005C00500072006F006700720061006D002000460069006C00650073005C00570069006E0064006F007700730041007000700073005C004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F0031002E00320031002E0032003900310031002E0030005F007800360034005F005F003800770065006B0079006200330064003800620062007700650000001D000000200000000048000000961020451B12594FAA1FDE0AAAA6F82E00000000CD010000315350534D0BD48669903C44819A2A54090DCCEC4D0000000C000000001F0000001D00000049006D0061006700650073005C0053007100750061007200650031003500300078003100350030004C006F0067006F002E0070006E006700000000004900000002000000001F0000001B00000049006D0061006700650073005C00530071007500610072006500340034007800340034004C006F0067006F002E0070006E00670000000000490000000D000000001F0000001B00000049006D0061006700650073005C00570069006400650033003100300078003100350030004C006F0067006F002E0070006E00670000000000110000000400000000130000000078D4FF11000000050000000013000000FFFFFFFF3D00000013000000001F0000001500000049006D0061006700650073005C004C006100720067006500540069006C0065002E0070006E00670000000000110000000E0000000013000000A1040000250000000B000000001F000000090000005400650072006D0069006E0061006C00000000003D00000014000000001F0000001500000049006D0061006700650073005C0053006D0061006C006C00540069006C0065002E0070006E00670000000000000000003100000031535053B1166D44AD8D7048A748402EA43D788C15000000640000000015000000036E01000000000000000000410000003153505330F125B7EF471A10A5F102608C9EEBAC250000000A000000001F000000090000005400650072006D0069006E0061006C0000000000000000002D00000031535053B377ED0D14C66C45AE5B285B38D7B01B110000000700000000130000000000000000000000000000000000640000001D00EFBE02004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B00790062003300640038006200620077006500210041007000700000000005220000001E00EFBE02005500730065007200500069006E006E006500640000000005120000002B00EFBE0D30EA167C25DB010005640000001D00EFBE02004D006900630072006F0073006F00660074002E00570069006E0064006F00770073005400650072006D0069006E0061006C005F003800770065006B00790062003300640038006200620077006500210041007000700000000005000000000000 /f


:: Refresh Explorer to apply changes
taskkill /f /im explorer.exe
start explorer.exe


:: Set the downloaded image as wallpaper
reg add "HKCU\Control Panel\Desktop" /v "Wallpaper" /t REG_SZ /d "%imageFile%" /f

:: Update the wallpaper immediately
RUNDLL32.EXE user32.dll, UpdatePerUserSystemParameters ,1 ,True

echo Changes applied successfully!
pause